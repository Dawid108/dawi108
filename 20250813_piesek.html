<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Piesek — opiekuj się 🐶</title>
  <style>
    :root{
      --bg: #f7f7ff;
      --card: #ffffff;
      --brand: #6c5ce7;
      --brand-2:#00b894;
      --ink: #2d2a32;
      --muted:#8b8b99;
      --shadow: 0 10px 30px rgba(0,0,0,.10);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, Noto Sans, "Apple Color Emoji","Segoe UI Emoji";
      background: linear-gradient(180deg, #eff3ff, #fff);
      color:var(--ink);
    }
    .app{
      min-height:100%;
      display:grid;
      grid-template-rows:auto 1fr auto;
      gap:12px;
      padding: clamp(10px, 2vw, 20px);
    }
    header{
      display:flex; align-items:center; justify-content:space-between;
      background:var(--card); border-radius:20px; padding:14px 16px; box-shadow:var(--shadow);
    }
    header h1{margin:0; font-size:clamp(18px, 3.6vw, 28px)}
    .coins{font-weight:bold; font-size:16px; color:var(--brand-2)}

    .progress{display:flex; gap:6px; align-items:center; flex-wrap:wrap}
    .step{
      width:28px; height:28px; display:grid; place-items:center; border-radius:10px; background:#eef2ff; color:#5b5b66;
      box-shadow: inset 0 0 0 2px #d9dffb;
      font-size:18px;
      transition:.2s;
    }
    .step.active{background:#dfe6ff; transform:translateY(-1px); box-shadow:inset 0 0 0 2px var(--brand)}
    .step.done{background:#e9fff7; box-shadow:inset 0 0 0 2px var(--brand-2)}

    .game{
      display:grid; grid-template-columns:1fr; gap:12px;
    }

    .stage{
      background:var(--card); border-radius:24px; padding:14px; box-shadow:var(--shadow);
      display:grid; grid-template-rows:auto 1fr; gap:10px; min-height:55vh;
    }
    .scene{
      position:relative; border-radius:20px; background:linear-gradient(180deg, #c9f1ff, #f7fbff);
      overflow:hidden; min-height:45vh; display:grid; place-items:center;
    }
    .floor{position:absolute; inset:auto 0 0 0; height:35%; background:linear-gradient(180deg,#fff,#f0f0f6)}

    .dog{
      position:relative; width:min(42vmin, 320px); height:min(42vmin, 320px);
      display:grid; place-items:center; font-size: min(22vmin, 180px);
      user-select:none; touch-action:none; cursor:default;
      filter: drop-shadow(0 10px 20px rgba(0,0,0,.12));
    }
    .dog .emoji{pointer-events:none}

    /* overlays */
    .spots{position:absolute; inset:0; pointer-events:none; background-repeat:no-repeat;}
    .foam{position:absolute; inset:0; pointer-events:none; opacity:0; transition:opacity .2s ease;}
    .messy{position:absolute; inset:0; pointer-events:none; display:none; background: radial-gradient(circle at 50% 40%, #3d3d3d 30%, transparent 60%); opacity:0.6;}
    .longfur{position:absolute; inset:0; pointer-events:none; background: repeating-linear-gradient(180deg, #7a5d45 0 8px, #6b4e39 8px 16px); -webkit-mask:radial-gradient(65% 65% at 50% 45%, black 70%, transparent 100%); mask:radial-gradient(65% 65% at 50% 45%, black 70%, transparent 100%); opacity:0; transition:opacity .25s ease;}

    .tooltray{display:grid; grid-template-columns:repeat(6, minmax(0,1fr)); gap:10px;}
    .tool{background:var(--card); border-radius:18px; padding:10px; box-shadow:var(--shadow); display:flex; align-items:center; justify-content:center; min-height:64px; font-size:28px; cursor:pointer; user-select:none; touch-action:none; position:relative; transition:.15s transform;}
    .tool:active{transform:scale(.98)}
    .tool.locked{opacity:.35; pointer-events:none; filter:grayscale(1)}
    .badge{position:absolute; top:6px; right:8px; font-size:12px; color:#fff; background:var(--brand); border-radius:999px; padding:2px 6px; box-shadow:var(--shadow)}

    .hint{font-size:clamp(14px, 2.6vw, 18px); color:var(--muted)}

    .toast{position:fixed; left:50%; bottom:20px; transform:translateX(-50%); background: #111; color:#fff; padding:10px 14px; border-radius:999px; box-shadow:var(--shadow); opacity:0; pointer-events:none; transition:.25s; z-index:50; font-size:14px}
    .toast.show{opacity:.95}

    .kitchen{background: linear-gradient(180deg, #ffe9d6, #fff4ea)}
    .room{background: linear-gradient(180deg, #e6f7ff, #fbfdff)}
    .bedroom{background: linear-gradient(180deg, #efe9ff, #faf7ff)}

    .table{position:absolute; bottom:10%; width:80%; height:26%; background:#fff; border-radius:20px; box-shadow:var(--shadow); left:10%; display:grid; place-items:center}
    .foodbar{display:flex; gap:12px}
    .food{font-size:34px; width:64px; height:64px; display:grid; place-items:center; background:#fff; border-radius:16px; box-shadow:var(--shadow); cursor:grab}
    .food:active{cursor:grabbing}

    .ball{position:absolute; bottom:14%; left:14%; font-size:50px; cursor:pointer; display:none}
    .bed{position:absolute; bottom:12%; left:50%; transform:translateX(-50%); font-size:72px; display:none}

    .floating{position:absolute; pointer-events:none; font-size:28px; opacity:.9; animation:floatUp .9s ease forwards}
    @keyframes floatUp{to{transform:translateY(-30px); opacity:0}}

    .shop{position:fixed; top:0; right:0; width:70%; max-width:320px; height:100%; background:#fff; box-shadow:-4px 0 20px rgba(0,0,0,.2); transform:translateX(100%); transition:.3s; z-index:60; padding:20px; overflow-y:auto}
    .shop.open{transform:translateX(0)}
    .shop h2{margin-top:0}
    .item{display:flex; align-items:center; justify-content:space-between; padding:10px; border-bottom:1px solid #eee}
    .buy{background:var(--brand); color:#fff; border:none; border-radius:12px; padding:4px 10px; cursor:pointer}
  </style>
</head>
<body>
  <div class="app" id="app">
    <header>
      <h1>🐶 Piesek — opiekuj się pupilem</h1>      
      <div class="coins" id="coins">💰 0</div>
    </header>
<div class="game">
      <div class="stage">
        <div class="hint" id="hint">Dotknij 🚿 i przeciągnij po piesku, aby go umyć.</div>
        <div class="scene room" id="scene">
          <div class="floor"></div>
          <div class="dog" id="dog"><div class="emoji">🐶</div><div class="spots" id="spots"></div><div class="foam" id="foam"></div><div class="messy" id="messy"></div><div class="longfur" id="longfur"></div></div>
          <div class="ball" id="ball">⚽</div>
          <div class="bed" id="bed">🛏️</div>
          <div class="table" id="table" style="display:none"><div class="foodbar"><div class="food" data-food="karma">🦴</div><div class="food" data-food="jablko">🍏</div><div class="food" data-food="burger">🍔</div></div></div>
        </div>
      </div>

      <div class="tooltray">
        <div class="tool" id="tool-shower-1"><span>🚿</span><span class="badge">1</span></div>
        <div class="tool locked" id="tool-sponge"><span>🧽</span><span class="badge">2</span></div>
        <div class="tool locked" id="tool-shower-2"><span>🚿</span><span class="badge">3</span></div>
        <div class="tool locked" id="tool-comb"><span>🪮</span><span class="badge">4</span></div>
        <div class="tool locked" id="tool-scissors"><span>✂️</span><span class="badge">5</span></div>
        <div class="tool locked" id="tool-kitchen"><span>🍳</span><span class="badge">6</span></div>
        <div class="tool locked" id="tool-room"><span>🛝</span><span class="badge">7</span></div>
        <div class="tool locked" id="tool-bed"><span>🛏️</span><span class="badge">8</span></div>
        <div class="tool" id="tool-shop"><span>🏪</span></div>
      </div>
    </div>

    <div class="toast" id="toast">Gotowe!</div>

    <div class="shop" id="shop">
      <h2>Sklep</h2>
      <div class="item">Inny piesek 🐕 <button class="buy" data-cost="50">Kup (50)</button></div>
      <div class="item">Kot 🐱 <button class="buy" data-cost="80">Kup (80)</button></div>
      <div class="item">Piłka 🏀 <button class="buy" data-cost="20">Kup (20)</button></div>
      <div class="item">Jedzenie 🍖 <button class="buy" data-cost="10">Kup (10)</button></div>
    </div>
  </div>

<script>
  (function(){
    const hint=document.getElementById('hint');
    const scene=document.getElementById('scene');
    const dog=document.getElementById('dog');
    const spots=document.getElementById('spots');
    const foam=document.getElementById('foam');
    const messy=document.getElementById('messy');
    const longfur=document.getElementById('longfur');
    const table=document.getElementById('table');
    const ball=document.getElementById('ball');
    const bed=document.getElementById('bed');
    const toast=document.getElementById('toast');
    const coinsEl=document.getElementById('coins');
    const shop=document.getElementById('shop');

    let coins=0;
    function addCoins(n){coins+=n; coinsEl.textContent='💰 '+coins;}
    function showToast(t){toast.textContent=t;toast.classList.add('show');setTimeout(()=>toast.classList.remove('show'),1200);}

    // Dragging only at bed step
    let dragEnabled=false;

    function overDog(p){const r=dog.getBoundingClientRect();return p.x>r.left&&p.x<r.right&&p.y>r.top&&p.y<r.bottom;}

    // Shower gradual cleaning
    initDragTool('tool-shower-1',(pt)=>{
      if(overDog(pt)){
        spots.style.background=`radial-gradient(#5d4037 6px transparent 10px)`;
        spots.style.opacity=(parseFloat(spots.style.opacity||1)-0.05);
        if(spots.style.opacity<0.2){spots.style.display='none';showToast('Czysty!');addCoins(3);}
      }
    });

    // Sponge rub
    document.getElementById('tool-sponge').addEventListener('click',()=>{foam.style.opacity=1;showToast('Piana!');addCoins(5)});

    // Shower 2 rinse
    initDragTool('tool-shower-2',(pt)=>{if(overDog(pt)){foam.style.opacity-=0.1;if(foam.style.opacity<=0){foam.style.opacity=0;messy.style.display='block';showToast('Spłukany!');}}});

    // Comb tidy
    initDragTool('tool-comb',(pt)=>{if(overDog(pt)){messy.style.display='none';longfur.style.opacity=1;showToast('Uczesany!');addCoins(2)}});

    // Scissors trim gradually
    initDragTool('tool-scissors',(pt)=>{if(overDog(pt)){longfur.style.opacity-=0.1;if(longfur.style.opacity<=0){longfur.style.opacity=0;showToast('Obcięty!');addCoins(7)}}});

    // Food drag
    scene.addEventListener('pointerdown',(e)=>{const f=e.target.closest('.food');if(!f)return;let ghost=f.cloneNode(true);ghost.style.position='fixed';ghost.style.left=e.clientX+'px';ghost.style.top=e.clientY+'px';document.body.appendChild(ghost);const move=(ev)=>{ghost.style.left=ev.clientX+'px';ghost.style.top=ev.clientY+'px';};const up=(ev)=>{if(overDog({x:ev.clientX,y:ev.clientY})){showToast('Zjadł!');addCoins(1);}ghost.remove();window.removeEventListener('pointermove',move);window.removeEventListener('pointerup',up);};window.addEventListener('pointermove',move);window.addEventListener('pointerup',up);});

    // Ball play => coins
    ball.addEventListener('click',(e)=>{addCoins(1);ball.style.left=Math.random()*70+'%';ball.style.bottom=(10+Math.random()*60)+'%';});

    // Bed drag only step
    document.getElementById('tool-bed').addEventListener('click',()=>{dragEnabled=true;bed.style.display='block';});
    dog.addEventListener('pointerdown',(e)=>{if(!dragEnabled)return;let ghost=dog.cloneNode(true);ghost.style.position='fixed';ghost.style.left=e.clientX+'px';ghost.style.top=e.clientY+'px';document.body.appendChild(ghost);const move=(ev)=>{ghost.style.left=ev.clientX+'px';ghost.style.top=ev.clientY+'px';};const up=(ev)=>{const br=bed.getBoundingClientRect();if(ev.clientX>br.left&&ev.clientX<br.right&&ev.clientY>br.top&&ev.clientY<br.bottom){showToast('Dobranoc!');addCoins(20);}ghost.remove();window.removeEventListener('pointermove',move);window.removeEventListener('pointerup',up);};window.addEventListener('pointermove',move);window.addEventListener('pointerup',up);});

    // Shop
    document.getElementById('tool-shop').addEventListener('click',()=>{shop.classList.toggle('open')});
    shop.addEventListener('click',(e)=>{if(e.target.classList.contains('buy')){let cost=parseInt(e.target.dataset.cost);if(coins>=cost){coins-=cost;coinsEl.textContent='💰 '+coins;showToast('Kupiono!')}else{showToast('Za mało monet!')}}});

    function initDragTool(id,cb){const el=document.getElementById(id);el.addEventListener('pointerdown',(e)=>{let ghost=el.cloneNode(true);ghost.style.position='fixed';ghost.style.left=e.clientX+'px';ghost.style.top=e.clientY+'px';document.body.appendChild(ghost);const move=(ev)=>{ghost.style.left=ev.clientX+'px';ghost.style.top
  </script>
</body>
</html>
