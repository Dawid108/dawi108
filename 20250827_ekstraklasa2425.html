<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Liga piłkarska (24 drużyny) – sezon 24/25</title>
<style>
    :root{
      --bg:#0f172a; /* slate-900 */
      --card:#111827ee; /* gray-900 */
      --muted:#94a3b8; /* slate-400 */
      --text:#e5e7eb; /* gray-200 */
      --acc1:#22c55e; /* green-500 */
      --acc2:#3b82f6; /* blue-500 */
      --acc3:#f59e0b; /* amber-500 */
      --ring: #60a5fa;
      --shadow: 0 10px 25px rgba(0,0,0,.35);
      --radius: 16px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji","Segoe UI Emoji";
      color:var(--text); background:
        radial-gradient(60% 80% at 20% 10%, #1f2937 0%, transparent 70%),
        radial-gradient(70% 70% at 80% 0%, #0b3b6a 0%, transparent 60%),
        linear-gradient(180deg, #0b1020, #0a0f1e 60%, #0f172a);
      min-height:100%;
      -webkit-tap-highlight-color: transparent;
    }
    .container{max-width:900px; margin:0 auto; padding:16px; padding-bottom:80px}

    header{
      position:sticky; top:0; z-index:10; backdrop-filter:saturate(1.2) blur(8px);
      background:linear-gradient(180deg, rgba(2,6,23,.85), rgba(2,6,23,.65));
      border-bottom:1px solid rgba(148,163,184,.15);
    }
    .topbar{display:flex; gap:10px; align-items:center; padding:12px 16px;}
    .title{font-weight:700; letter-spacing:.4px; font-size:18px}
    .spacer{flex:1}

    .segmented{
      display:flex; background:rgba(148,163,184,.12); border-radius:999px; padding:4px;
      box-shadow: inset 0 0 0 1px rgba(148,163,184,.18);
    }
    .segmented button{
      appearance:none; border:0; padding:8px 14px; border-radius:999px; color:var(--text);
      background:transparent; font-weight:600; letter-spacing:.2px; cursor:pointer;
    }
    .segmented button.active{ background:linear-gradient(180deg, #1f2937, #0f172a); box-shadow:var(--shadow); }

    h1{font-size:22px; margin:18px 6px 10px}

    .card{ background:var(--card); border:1px solid rgba(148,163,184,.12); border-radius:var(--radius); box-shadow:var(--shadow); }

    /* Tabela */
    table{ width:100%; border-collapse:separate; border-spacing:0 10px; }
    thead th{ text-align:left; font-size:12px; color:var(--muted); font-weight:700; padding:0 12px; }
    tbody tr{ background:rgba(2,6,23,.66); box-shadow:0 8px 16px rgba(0,0,0,.25); }
    tbody td{ padding:12px; }
    tbody tr:first-child{ outline:1px solid rgba(34,197,94,.35); }
    .pos{ width:52px; text-align:center; font-weight:800; color:#93c5fd; }
    .team{ font-weight:700; }
    .pts{ width:72px; text-align:right; font-weight:800; color:#fcd34d; }

    /* Mecze */
    .toolbar{ display:flex; gap:10px; align-items:center; padding:12px; flex-wrap:wrap }
    .select{ flex:1; display:flex; align-items:center; gap:8px }
    .select label{ color:var(--muted); font-size:12px; }
    select{ width:100%; padding:10px 12px; border-radius:12px; border:1px solid rgba(148,163,184,.25); background:#0b1222; color:var(--text); font-weight:600; }

    .match{ display:flex; align-items:center; justify-content:space-between; gap:8px; padding:12px; margin:10px; border-radius:14px; border:1px solid rgba(148,163,184,.18); background:rgba(15,23,42,.85); box-shadow:var(--shadow); }
    .teams{ display:flex; gap:6px; align-items:center; font-weight:700; }
    .vs{ color:var(--muted); font-weight:700; }

    .outcome{ display:flex; gap:6px; }
    .pill{
      display:inline-flex; align-items:center; justify-content:center;
      min-width:52px; padding:8px 10px; border-radius:999px; border:1px solid rgba(148,163,184,.25);
      background:rgba(2,6,23,.5); color:var(--text); font-weight:800; cursor:pointer; user-select:none;
    }
    .pill[data-type="H"]{ box-shadow: 0 0 0 1px rgba(59,130,246,.35) inset; }
    .pill[data-type="D"]{ box-shadow: 0 0 0 1px rgba(245,158,11,.35) inset; }
    .pill[data-type="A"]{ box-shadow: 0 0 0 1px rgba(34,197,94,.35) inset; }
    .pill.active{ background:linear-gradient(180deg,aqua,lime); transform:translateY(-1px); }

    .footer-note{ color:var(--muted); font-size:12px; padding:10px 14px; }

    /* Buttons */
    .btn-reset{ margin-left:auto; appearance:none; border:0; padding:10px 14px; border-radius:12px; font-weight:700; cursor:pointer; color:#fca5a5; background:rgba(239,68,68,.15); border:1px solid rgba(239,68,68,.3); }

    @media (hover:hover){
      .pill:hover{ filter:brightness(1.15) }
      .segmented button:hover{ filter:brightness(1.1) }
      .btn-reset:hover{ filter:brightness(1.1) }
    }
  </style>
</head>
<body>
<header>
    <div class="topbar">
      <div class="title">Liga piłkarska 24/25 – 24 drużyny</div>
      <div class="spacer"></div>
      <div class="segmented" role="tablist" aria-label="Nawigacja widoków">
        <button id="btnTabela" class="active" role="tab" aria-selected="true">Tabela</button>
        <button id="btnMecze" role="tab" aria-selected="false">Mecze</button>
      </div>
    </div>
  </header>

  <main class="container">
    <h1 id="viewTitle">Tabela</h1>

    <!-- Widok: Tabela -->
    <section id="viewTabela" class="card" aria-labelledby="viewTitle">
      <div style="overflow:auto; padding:12px;">
        <table aria-label="Tabela ligowa">
          <thead>
            <tr>
              <th style="width:52px">M</th>
              <th>Drużyna</th>
              <th style="width:72px; text-align:right">Pkt</th>
            </tr>
          </thead>
          <tbody id="tableBody"></tbody>
        </table>
      </div>
      <div class="footer-note">Punkty: wygrana 3, remis 1, porażka 0. Wyniki ustalasz w zakładce „Mecze”.</div>
    </section>

    <!-- Widok: Mecze -->
    <section id="viewMecze" class="card" style="display:none">
      <div class="toolbar">
        <div class="select" style="flex:1">
          <label for="roundSelect">Kolejka</label>
          <select id="roundSelect" aria-label="Wybierz kolejkę"></select>
        </div>
      </div>
      <div id="matchesWrap"></div>
      <div class="footer-note">Dotknij wynik, aby ustawić: <b>1–0</b> (gospodarz), <b>1–1</b> (remis), <b>0–1</b> (gość).</div>
    </section>
  </main>

  <script>
  (function(){
    const STORAGE_KEY = 'liga_pilka3_2425';
    const state = loadState();

    const teams = state.teams;
    const fixtures = state.fixtures; // [round][match] -> {home, away, result}

    const btnTabela = document.getElementById('btnTabela');
    const btnMecze  = document.getElementById('btnMecze');
    const viewTabela= document.getElementById('viewTabela');
    const viewMecze = document.getElementById('viewMecze');
    const viewTitle = document.getElementById('viewTitle');
    const tableBody = document.getElementById('tableBody');
    const roundSelect = document.getElementById('roundSelect');
    const matchesWrap = document.getElementById('matchesWrap');
    const resetBtn = document.getElementById('resetBtn');

    buildRoundSelect();
    renderTable();
    renderMatches(state.lastRound || 0);
    applyInitialView();

    btnTabela.addEventListener('click', ()=>switchView('tabela'));
    btnMecze.addEventListener('click', ()=>switchView('mecze'));
    roundSelect.addEventListener('change', ()=>{
      const idx = parseInt(roundSelect.value,10) || 0;
      state.lastRound = idx; saveState();
      renderMatches(idx);
    });
    resetBtn.addEventListener('click', ()=>{
      if(confirm('Na pewno wyczyścić wszystkie wyniki?')){
        fixtures.forEach(r=>r.forEach(m=>m.result=null));
        saveState();
        renderMatches(state.lastRound||0);
        renderTable();
      }
    });

    function loadState(){
      const defaultTeams = [
        "Lech Poznań","Jagiellonia Białystok","Śląsk Wrocław","Cracovia","Zagłębie Lubin","Górnik Zabrze","Pogoń Szczecin","Błyskawica","Raków Częstochowa","Astra Krotoszyn","Barcelona","Tottenham","Chelsea","Arsenal","AC Milan","Inter Mediolan","Atalanta","Juventus","Dinamo Zagrzeb","VfB Stuttgart","Sparta Praga","RB Lipsk","Girona","Young Boys"
      ];
      let parsed=null;
      try{ parsed = JSON.parse(localStorage.getItem(STORAGE_KEY)||'null'); }catch(e){ parsed=null }
      if(parsed && parsed.teams?.length===defaultTeams.length && isValidFixtures(parsed.fixtures, defaultTeams.length)){
        return parsed;
      }
      const fx = generateFixtures(defaultTeams.length);
      const stateObj = { teams: defaultTeams, fixtures: fx, lastView: 'tabela', lastRound: 0 };
      localStorage.setItem(STORAGE_KEY, JSON.stringify(stateObj));
      return stateObj;
    }

    function isValidFixtures(fixtures, n){
      if(!Array.isArray(fixtures)) return false;
      if(fixtures.length !== 2*(n-1)) return false;
      const perRound = n/2;
      for(const round of fixtures){
        if(!Array.isArray(round) || round.length !== perRound) return false;
        const seen = new Set();
        for(const m of round){
          if(typeof m.home!=='number' || typeof m.away!=='number') return false;
          if(seen.has(m.home) || seen.has(m.away)) return false;
          seen.add(m.home); seen.add(m.away);
        }
      }
      return true;
    }

    function generateFixtures(n){
      const rounds = n - 1;
      const perRound = n / 2;
      const players = Array.from({length:n}, (_,i)=>i);

      const single = [];
      for(let r=0; r<rounds; r++){
        const matches = [];
        for(let i=0; i<perRound; i++){
          const home = players[i];
          const away = players[n-1-i];
          if(i===0 && r%2===1){
            matches.push({home: away, away: home, result: null});
          } else {
            matches.push({home, away, result: null});
          }
        }
        single.push(matches);
        const fixed = players[0];
        const rest = players.slice(1);
        rest.unshift(rest.pop());
        players.splice(1, rest.length, ...rest);
      }

      const mirror = single.map(round => round.map(m => ({home: m.away, away: m.home, result: null})));
      return [...single, ...mirror];
    }

    function saveState(){ localStorage.setItem(STORAGE_KEY, JSON.stringify(state)); }

    function buildRoundSelect(){
      roundSelect.innerHTML = '';
      for(let i=0;i<fixtures.length;i++){
        const opt = document.createElement('option');
        opt.value = i; opt.textContent = `Kolejka ${i+1} / ${fixtures.length}`;
        roundSelect.appendChild(opt);
      }
      roundSelect.value = String(state.lastRound||0);
    }

    function computeTable(){
      const pts = Array.from({length: teams.length}, ()=>0);
      fixtures.forEach(round=>{
        round.forEach(m=>{
          if(!m.result) return;
          if(m.result==='1-0'){ pts[m.home]+=3; }
          else if(m.result==='0-1'){ pts[m.away]+=3; }
          else if(m.result==='1-1'){ pts[m.home]+=1; pts[m.away]+=1; }
        });
      });
      const rows = teams.map((name,idx)=>({ idx, name, pts: pts[idx] }));
      rows.sort((a,b)=> b.pts - a.pts || a.name.localeCompare(b.name) || a.idx-b.idx );
      return rows;
    }

    function renderTable(){
      const rows = computeTable();
      tableBody.innerHTML = '';
      rows.forEach((row,i)=>{
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td class="pos">${i+1}</td>
          <td class="team">${row.name}</td>
          <td class="pts">${row.pts}</td>
        `;
        tableBody.appendChild(tr);
      });
    }

    function renderMatches(roundIdx){
      matchesWrap.innerHTML = '';
      const round = fixtures[roundIdx];
      round.forEach((m, i)=>{
        const el = document.createElement('div');
        el.className = 'match';
        const label = `${teams[m.home]} <span class="vs">vs</span> ${teams[m.away]}`;
        el.innerHTML = `
          <div class="teams">${label}</div>
          <div class="outcome" role="group" aria-label="Wynik meczu">
            <div class="pill ${m.result==='1-0'?'active':''}" data-type="H" data-value="1-0">1–0</div>
            <div class="pill ${m.result==='1-1'?'active':''}" data-type="D" data-value="1-1">1–1</div>
            <div class="pill ${m.result==='0-1'?'active':''}" data-type="A" data-value="0-1">0–1</div>
          </div>`;
        el.querySelectorAll('.pill').forEach(p=>{
          p.addEventListener('click', ()=>{
            const val = p.getAttribute('data-value');
            const isActive = p.classList.contains('active');
            el.querySelectorAll('.pill').forEach(x=>x.classList.remove('active'));
            if(isActive){
              fixtures[roundIdx][i].result = null;
            } else {
              p.classList.add('active');
              fixtures[roundIdx][i].result = val;
            }
            saveState();
            renderTable();
          });
        });
        matchesWrap.appendChild(el);
      });
      roundSelect.value = String(roundIdx);
    }

    function switchView(view){
      if(view==='tabela'){
        viewTabela.style.display='block';
        viewMecze.style.display='none';
        btnTabela.classList.add('active');
        btnMecze.classList.remove('active');
        viewTitle.textContent='Tabela';
        state.lastView='tabela';
      } else {
        viewTabela.style.display='none';
        viewMecze.style.display='block';
        btnMecze.classList.add('active');
        btnTabela.classList.remove('active');
        viewTitle.textContent='Mecze';
        state.lastView='mecze';
      }
      saveState();
    }

    function applyInitialView(){
      if(state.lastView==='mecze') switchView('mecze'); else switchView('tabela');
    }
  })();
  </script>
</body>
</html>
